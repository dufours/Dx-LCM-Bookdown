<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 7 Multiple populations | Bayesian latent class models for prevalence estimation and diagnostic test evaluation</title>
  <meta name="description" content="Chapitre 7" />
  <meta name="generator" content="bookdown 0.26 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 7 Multiple populations | Bayesian latent class models for prevalence estimation and diagnostic test evaluation" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Chapitre 7" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 7 Multiple populations | Bayesian latent class models for prevalence estimation and diagnostic test evaluation" />
  
  <meta name="twitter:description" content="Chapitre 7" />
  

<meta name="author" content="Simon Dufour and Juan Carlos Arango Sabogal" />


<meta name="date" content="2022-05-20" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="exercise-2---two-tests-one-population.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Bayesian latent class models</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> About this document</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#some-notation"><i class="fa fa-check"></i><b>1.1</b> Some notation</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="distributions.html"><a href="distributions.html"><i class="fa fa-check"></i><b>2</b> Distributions</a>
<ul>
<li class="chapter" data-level="2.1" data-path="distributions.html"><a href="distributions.html#prior-distributions"><i class="fa fa-check"></i><b>2.1</b> Prior distributions</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="distributions.html"><a href="distributions.html#normal-distribution"><i class="fa fa-check"></i><b>2.1.1</b> Normal distribution</a></li>
<li class="chapter" data-level="2.1.2" data-path="distributions.html"><a href="distributions.html#uniform-distribution"><i class="fa fa-check"></i><b>2.1.2</b> Uniform distribution</a></li>
<li class="chapter" data-level="2.1.3" data-path="distributions.html"><a href="distributions.html#beta-distribution"><i class="fa fa-check"></i><b>2.1.3</b> Beta distribution</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="distributions.html"><a href="distributions.html#distributions-for-likelihood-functions"><i class="fa fa-check"></i><b>2.2</b> Distributions for likelihood functions</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="distributions.html"><a href="distributions.html#binomial-distribution"><i class="fa fa-check"></i><b>2.2.1</b> Binomial distribution</a></li>
<li class="chapter" data-level="2.2.2" data-path="distributions.html"><a href="distributions.html#multinomial-distribution"><i class="fa fa-check"></i><b>2.2.2</b> Multinomial distribution</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="running-bayesian-models.html"><a href="running-bayesian-models.html"><i class="fa fa-check"></i><b>3</b> Running Bayesian models</a>
<ul>
<li class="chapter" data-level="3.1" data-path="running-bayesian-models.html"><a href="running-bayesian-models.html#the-data"><i class="fa fa-check"></i><b>3.1</b> The data</a></li>
<li class="chapter" data-level="3.2" data-path="running-bayesian-models.html"><a href="running-bayesian-models.html#the-model"><i class="fa fa-check"></i><b>3.2</b> The model</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="running-bayesian-models.html"><a href="running-bayesian-models.html#the-likelihood-function"><i class="fa fa-check"></i><b>3.2.1</b> The likelihood function</a></li>
<li class="chapter" data-level="3.2.2" data-path="running-bayesian-models.html"><a href="running-bayesian-models.html#priors-for-unkown-parameters"><i class="fa fa-check"></i><b>3.2.2</b> Priors for unkown parameters</a></li>
<li class="chapter" data-level="3.2.3" data-path="running-bayesian-models.html"><a href="running-bayesian-models.html#creating-the-jags-model"><i class="fa fa-check"></i><b>3.2.3</b> Creating the JAGS model</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="running-bayesian-models.html"><a href="running-bayesian-models.html#generating-initial-values"><i class="fa fa-check"></i><b>3.3</b> Generating initial values</a></li>
<li class="chapter" data-level="3.4" data-path="running-bayesian-models.html"><a href="running-bayesian-models.html#running-a-model-in-jags"><i class="fa fa-check"></i><b>3.4</b> Running a model in JAGS</a></li>
<li class="chapter" data-level="3.5" data-path="running-bayesian-models.html"><a href="running-bayesian-models.html#model-diagnostic"><i class="fa fa-check"></i><b>3.5</b> Model diagnostic</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="running-bayesian-models.html"><a href="running-bayesian-models.html#convergence-and-burn-in"><i class="fa fa-check"></i><b>3.5.1</b> Convergence and burn-in</a></li>
<li class="chapter" data-level="3.5.2" data-path="running-bayesian-models.html"><a href="running-bayesian-models.html#number-of-iterations"><i class="fa fa-check"></i><b>3.5.2</b> Number of iterations</a></li>
<li class="chapter" data-level="3.5.3" data-path="running-bayesian-models.html"><a href="running-bayesian-models.html#auto-correlation"><i class="fa fa-check"></i><b>3.5.3</b> Auto-correlation</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="running-bayesian-models.html"><a href="running-bayesian-models.html#getting-our-estimates"><i class="fa fa-check"></i><b>3.6</b> Getting our estimates</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="exercise-1---proportions.html"><a href="exercise-1---proportions.html"><i class="fa fa-check"></i><b>4</b> Exercise 1 - Proportions</a>
<ul>
<li class="chapter" data-level="4.1" data-path="exercise-1---proportions.html"><a href="exercise-1---proportions.html#data"><i class="fa fa-check"></i><b>4.1</b> Data</a></li>
<li class="chapter" data-level="4.2" data-path="exercise-1---proportions.html"><a href="exercise-1---proportions.html#questions"><i class="fa fa-check"></i><b>4.2</b> Questions</a></li>
<li class="chapter" data-level="4.3" data-path="exercise-1---proportions.html"><a href="exercise-1---proportions.html#answers"><i class="fa fa-check"></i><b>4.3</b> Answers</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="two-imperfect-tests-one-population.html"><a href="two-imperfect-tests-one-population.html"><i class="fa fa-check"></i><b>5</b> Two imperfect tests, one population</a>
<ul>
<li class="chapter" data-level="5.1" data-path="two-imperfect-tests-one-population.html"><a href="two-imperfect-tests-one-population.html#assuming-conditional-independence"><i class="fa fa-check"></i><b>5.1</b> Assuming conditional independence</a></li>
<li class="chapter" data-level="5.2" data-path="two-imperfect-tests-one-population.html"><a href="two-imperfect-tests-one-population.html#allowing-for-conditional-dependence"><i class="fa fa-check"></i><b>5.2</b> Allowing for conditional dependence</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="exercise-2---two-tests-one-population.html"><a href="exercise-2---two-tests-one-population.html"><i class="fa fa-check"></i><b>6</b> Exercise 2 - Two tests, one population</a>
<ul>
<li class="chapter" data-level="6.1" data-path="exercise-2---two-tests-one-population.html"><a href="exercise-2---two-tests-one-population.html#questions-1"><i class="fa fa-check"></i><b>6.1</b> Questions</a></li>
<li class="chapter" data-level="6.2" data-path="exercise-2---two-tests-one-population.html"><a href="exercise-2---two-tests-one-population.html#answers-1"><i class="fa fa-check"></i><b>6.2</b> Answers</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="multiple-populations.html"><a href="multiple-populations.html"><i class="fa fa-check"></i><b>7</b> Multiple populations</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Bayesian latent class models for prevalence estimation and diagnostic test evaluation</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="multiple-populations" class="section level1 hasAnchor" number="7">
<h1><span class="header-section-number">Chapter 7</span> Multiple populations<a href="multiple-populations.html#multiple-populations" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In some situations, the diagnostic tests will be applied in two or more populations with different disease prevalence. In such cases, it could be reasonable to assume that:</p>
<ul>
<li>The prevalence varies from one population to another<br />
</li>
<li>The tests Se and Sp are constant from one population to another</li>
</ul>
<p>It could then be advantageous to model the different populations simultaneously in a same LCM as described by <a href="https://www.jstor.org/stable/2530508?seq=1">Hui and Walter (1980)</a>. With two populations, we would have six unknown parameters (<em>SeA</em> and <em>SpA</em>, <em>SeB</em> and <em>SpB</em>, and each population’s prevalence, <em>P1</em> and <em>P2</em>). When conducting two diagnostic tests in two populations, the data generated can be presented as two 2x2 tables presenting the cross-classified results of the two tests.</p>
<p><strong>Table.</strong> Cross-classified results from two diagnostic tests in two populations.</p>
<table>
<colgroup>
<col width="17%" />
<col width="12%" />
<col width="12%" />
<col width="15%" />
<col width="17%" />
<col width="12%" />
<col width="12%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"><strong>Population 1</strong></th>
<th align="center"></th>
<th align="center"></th>
<th align="center"></th>
<th align="center"><strong>Population 2</strong></th>
<th align="center"></th>
<th align="center"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"></td>
<td align="center"><strong>Test A+</strong></td>
<td align="center"><strong>Test A-</strong></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"><strong>Test A+</strong></td>
<td align="center"><strong>Test A-</strong></td>
</tr>
<tr class="even">
<td align="center"><strong>Test B+</strong></td>
<td align="center">Pop1 n1</td>
<td align="center">Pop1 n3</td>
<td align="center"></td>
<td align="center"><strong>Test B+</strong></td>
<td align="center">Pop2 n1</td>
<td align="center">Pop2 n3</td>
</tr>
<tr class="odd">
<td align="center"><strong>Test B-</strong></td>
<td align="center">Pop1 n2</td>
<td align="center">Pop1 n4</td>
<td align="center"></td>
<td align="center"><strong>Test B-</strong></td>
<td align="center">Pop2 n2</td>
<td align="center">Pop2 n4</td>
</tr>
</tbody>
</table>
<p>We can see from these 2x2 tables that we have 6 degrees of freedom available. Indeed, in each of the 2x2 table, we have three cells that do contribute a valuable information and the information in the 4th cell can be “guessed” using the total number of observations minus the content of the other three cells. The model proposed by <a href="https://www.jstor.org/stable/2530508?seq=1">Hui and Walter (1980)</a> is, therefore, barely identifiable.</p>
<p><a href="https://doi.org/10.20506/rst.40.1.3224">Cheung et al. (2021)</a> have described how the number of unknown parameters and the degrees of freedom vary as function of the number of population studied when comparing two conditionally independent diagnostic tests (see below).</p>
<p><strong>Table.</strong> Number of degrees of freedom and of unknown parameters when comparing two conditionally independent diagnostic tests across various number of populations (adapted from <a href="https://doi.org/10.20506/rst.40.1.3224">Cheung et al. (2021)</a>).</p>
<table>
<colgroup>
<col width="17%" />
<col width="25%" />
<col width="25%" />
<col width="31%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"><strong>Number of Populations</strong></th>
<th align="center"><strong>Number of unknown parameters (np)</strong></th>
<th align="center"><strong>Number of degrees of freedom (df)</strong></th>
<th align="center"><strong>Minimum number of informative priors needed</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">1</td>
<td align="center">5</td>
<td align="center">3</td>
<td align="center">2</td>
</tr>
<tr class="even">
<td align="center">2</td>
<td align="center">6</td>
<td align="center">6</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td align="center">3</td>
<td align="center">7</td>
<td align="center">9</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td align="center">4</td>
<td align="center">8</td>
<td align="center">12</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td align="center">p</td>
<td align="center">4+p</td>
<td align="center">3*p</td>
<td align="center">if df &lt; np, then np-df</td>
</tr>
</tbody>
</table>
<p>The likelihood function that could be used to link the observed data (<em>Pop1 n1</em>, <em>Pop1 n2</em>, …, <em>Pop2 n4</em>) to the unknown parameters (<em>SeA</em> and <em>SpA</em>, <em>SeB</em> and <em>SpB</em>, and <em>P1</em> and <em>P2</em>) can be described as follows:</p>
<p><span class="math inline">\(Ppop1[1:4] \sim dmulti(Pop1[1:4], nPop1)\)</span>
<span class="math inline">\(Ppop1_1 = P1*SeA*SeB + (1-P1)*(1-SpA)*(1-SpB)\)</span><br />
<span class="math inline">\(Ppop1_2 = P1*SeA*(1-SeB) + (1-P1)*(1-SpA)*SpB\)</span><br />
<span class="math inline">\(Ppop1_3 = P1*(1-SeA)*SeB + (1-P1)*SpA*(1-SpB)\)</span><br />
<span class="math inline">\(Ppop1_4 = P1*(1-SeA)*(1-SeB) + (1-P1)*SpA*SpB\)</span></p>
<p><span class="math inline">\(Ppop2[1:4] \sim dmulti(Pop2[1:4], nPop2)\)</span>
<span class="math inline">\(Ppop2_1 = P2*SeA*SeB + (1-P2)*(1-SpA)*(1-SpB)\)</span><br />
<span class="math inline">\(Ppop2_2 = P2*SeA*(1-SeB) + (1-P2)*(1-SpA)*SpB\)</span><br />
<span class="math inline">\(Ppop2_3 = P2*(1-SeA)*SeB + (1-P2)*SpA*(1-SpB)\)</span><br />
<span class="math inline">\(Ppop2_4 = P2*(1-SeA)*(1-SeB) + (1-P2)*SpA*SpB\)</span></p>
<p>Where <span class="math inline">\(Pop1_1\)</span> to <span class="math inline">\(Pop1_4\)</span> and <span class="math inline">\(Pop2_1\)</span> to <span class="math inline">\(Pop2_4\)</span> are the probabilities of falling in a given cell of the 2x2 table in population 1 and population 2, respectively; and <span class="math inline">\(nPop1\)</span> and <span class="math inline">\(nPop2\)</span> are the number of individuals tested in population 1 and 2, respectively. Thus, if you look carefully, <strong>we simply duplicated the likelihood function used before and we added subscripts to differentiate the cells, probabilities, and disease prevalence of the two populations.</strong> Cool hey? If you have three, four, etc populations, you can then extend the likelihood function to include them. With three or more populations, the model is not just <strong>barely</strong> identifiable anymore, it becomes fully identifiable.</p>
<p>To run such a model, we simply need to provide, for each population, a dataset where <em>n1</em>, <em>n2</em>, <em>n3</em>, and <em>n4</em> are listed (in that order). For instance, if we use herd #1 and herd #2 from the PAG <em>vs.</em> US study, we have the following 2x2 tables:</p>
<p><strong>Table.</strong> Cross-classified results from the PAG and US diagnostic tests in herd #1 and herd #2.</p>
<table style="width:100%;">
<colgroup>
<col width="12%" />
<col width="9%" />
<col width="9%" />
<col width="11%" />
<col width="12%" />
<col width="12%" />
<col width="9%" />
<col width="9%" />
<col width="11%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"><strong>Herd 1</strong></th>
<th align="center"></th>
<th align="center"></th>
<th align="center"><strong>Total</strong></th>
<th align="center"></th>
<th align="center"><strong>Herd 2</strong></th>
<th align="center"></th>
<th align="center"></th>
<th align="center"><strong>Total</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"></td>
<td align="center"><strong>US+</strong></td>
<td align="center"><strong>US-</strong></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"><strong>US+</strong></td>
<td align="center"><strong>US-</strong></td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="center"><strong>PAG+</strong></td>
<td align="center">138</td>
<td align="center">10</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"><strong>PAG+</strong></td>
<td align="center">71</td>
<td align="center">8</td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="center"><strong>PAG-</strong></td>
<td align="center">139</td>
<td align="center">123</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"><strong>PAG-</strong></td>
<td align="center">0</td>
<td align="center">69</td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="center"><strong>Total</strong></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">262</td>
<td align="center"></td>
<td align="center"><strong>Total</strong></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">148</td>
</tr>
</tbody>
</table>
<p>The dataset could, thus be created as follows:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="multiple-populations.html#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#n is of the form : (TestA pos and TestB pos), (TestA pos and TestB neg), (TestA neg and TestB pos), then (TestA neg and TestB neg)</span></span>
<span id="cb1-2"><a href="multiple-populations.html#cb1-2" aria-hidden="true" tabindex="-1"></a>datalist <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">Pop1=</span><span class="fu">c</span>(<span class="dv">138</span>,<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">113</span>),</span>
<span id="cb1-3"><a href="multiple-populations.html#cb1-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">Pop2=</span><span class="fu">c</span>(<span class="dv">71</span>, <span class="dv">0</span>, <span class="dv">8</span>, <span class="dv">69</span>)</span>
<span id="cb1-4"><a href="multiple-populations.html#cb1-4" aria-hidden="true" tabindex="-1"></a>                 )</span></code></pre></div>
<p>We could provide the values that will be used to described the prior distributions as we did before. The only difference is that we now have two prevalence parameters (<em>P1</em> and <em>P2</em>) to describe. In the example below, I will use vague priors for all parameters (just because we can!).</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="multiple-populations.html#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">#We could first create labels for TestA and TestB</span></span>
<span id="cb2-2"><a href="multiple-populations.html#cb2-2" aria-hidden="true" tabindex="-1"></a>TestA <span class="ot">&lt;-</span> <span class="st">&quot;US&quot;</span></span>
<span id="cb2-3"><a href="multiple-populations.html#cb2-3" aria-hidden="true" tabindex="-1"></a>TestB <span class="ot">&lt;-</span> <span class="st">&quot;PAG&quot;</span></span>
<span id="cb2-4"><a href="multiple-populations.html#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="multiple-populations.html#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Provide information for the prior distributions (all beta distributions) for the 6 unknown parameters </span></span>
<span id="cb2-6"><a href="multiple-populations.html#cb2-6" aria-hidden="true" tabindex="-1"></a>Prev1.shapea <span class="ot">&lt;-</span> <span class="dv">1</span>         <span class="co">#a shape parameter for Prev in population 1    </span></span>
<span id="cb2-7"><a href="multiple-populations.html#cb2-7" aria-hidden="true" tabindex="-1"></a>Prev1.shapeb <span class="ot">&lt;-</span> <span class="dv">1</span>         <span class="co">#b shape parameter for Prev in population 1</span></span>
<span id="cb2-8"><a href="multiple-populations.html#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="multiple-populations.html#cb2-9" aria-hidden="true" tabindex="-1"></a>Prev2.shapea <span class="ot">&lt;-</span> <span class="dv">1</span>         <span class="co">#a shape parameter for Prev in population 2    </span></span>
<span id="cb2-10"><a href="multiple-populations.html#cb2-10" aria-hidden="true" tabindex="-1"></a>Prev2.shapeb <span class="ot">&lt;-</span> <span class="dv">1</span>         <span class="co">#b shape parameter for Prev in population 2</span></span>
<span id="cb2-11"><a href="multiple-populations.html#cb2-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-12"><a href="multiple-populations.html#cb2-12" aria-hidden="true" tabindex="-1"></a>Se.TestA.shapea <span class="ot">&lt;-</span> <span class="dv">1</span>     <span class="co">#a shape parameter for Se of TestA</span></span>
<span id="cb2-13"><a href="multiple-populations.html#cb2-13" aria-hidden="true" tabindex="-1"></a>Se.TestA.shapeb <span class="ot">&lt;-</span> <span class="dv">1</span>     <span class="co">#b shape parameter for Se of TestA</span></span>
<span id="cb2-14"><a href="multiple-populations.html#cb2-14" aria-hidden="true" tabindex="-1"></a>Sp.TestA.shapea <span class="ot">&lt;-</span> <span class="dv">1</span>     <span class="co">#a shape parameter for Sp of TestA</span></span>
<span id="cb2-15"><a href="multiple-populations.html#cb2-15" aria-hidden="true" tabindex="-1"></a>Sp.TestA.shapeb <span class="ot">&lt;-</span> <span class="dv">1</span>     <span class="co">#b shape parameter for Sp of TestA</span></span>
<span id="cb2-16"><a href="multiple-populations.html#cb2-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-17"><a href="multiple-populations.html#cb2-17" aria-hidden="true" tabindex="-1"></a>Se.TestB.shapea <span class="ot">&lt;-</span> <span class="dv">1</span>     <span class="co">#a shape parameter for Se of TestB</span></span>
<span id="cb2-18"><a href="multiple-populations.html#cb2-18" aria-hidden="true" tabindex="-1"></a>Se.TestB.shapeb <span class="ot">&lt;-</span> <span class="dv">1</span>     <span class="co">#b shape parameter for Se of TestB</span></span>
<span id="cb2-19"><a href="multiple-populations.html#cb2-19" aria-hidden="true" tabindex="-1"></a>Sp.TestB.shapea <span class="ot">&lt;-</span> <span class="dv">1</span>     <span class="co">#a shape parameter for Sp of TestB</span></span>
<span id="cb2-20"><a href="multiple-populations.html#cb2-20" aria-hidden="true" tabindex="-1"></a>Sp.TestB.shapeb <span class="ot">&lt;-</span> <span class="dv">1</span>     <span class="co">#b shape parameter for Sp of TestB</span></span>
<span id="cb2-21"><a href="multiple-populations.html#cb2-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-22"><a href="multiple-populations.html#cb2-22" aria-hidden="true" tabindex="-1"></a><span class="co">#I will also need the total number of individuals tested in each population (nPop1 and nPop2)</span></span>
<span id="cb2-23"><a href="multiple-populations.html#cb2-23" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">sapply</span>(datalist, sum)</span>
<span id="cb2-24"><a href="multiple-populations.html#cb2-24" aria-hidden="true" tabindex="-1"></a>nPop1 <span class="ot">&lt;-</span> n[<span class="dv">1</span>]</span>
<span id="cb2-25"><a href="multiple-populations.html#cb2-25" aria-hidden="true" tabindex="-1"></a>nPop2 <span class="ot">&lt;-</span> n[<span class="dv">2</span>]</span></code></pre></div>
<p>With that, we have everything that is needed to write the JAGS model.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="multiple-populations.html#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Create the JAGS text file</span></span>
<span id="cb3-2"><a href="multiple-populations.html#cb3-2" aria-hidden="true" tabindex="-1"></a>model_2tests_2pop_indep <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;model{</span></span>
<span id="cb3-3"><a href="multiple-populations.html#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="multiple-populations.html#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="st">#=== LIKELIHOOD ===#</span></span>
<span id="cb3-5"><a href="multiple-populations.html#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="multiple-populations.html#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="st">  #=== POPULATION 1 ===#</span></span>
<span id="cb3-7"><a href="multiple-populations.html#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="st">  Pop1[1:4] ~ dmulti(p1[1:4], &quot;</span>,nPop1,<span class="st">&quot;)</span></span>
<span id="cb3-8"><a href="multiple-populations.html#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="st">  p1[1] &lt;- Prev1*Se_&quot;</span>, TestA, <span class="st">&quot;*Se_&quot;</span>, TestB, <span class="st">&quot; + (1-Prev1)*(1-Sp_&quot;</span>, TestA, <span class="st">&quot;)*(1-Sp_&quot;</span>, TestB, <span class="st">&quot;)</span></span>
<span id="cb3-9"><a href="multiple-populations.html#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="st">  p1[2] &lt;- Prev1*Se_&quot;</span>, TestA, <span class="st">&quot;*(1-Se_&quot;</span>, TestB, <span class="st">&quot;) + (1-Prev1)*(1-Sp_&quot;</span>, TestA, <span class="st">&quot;)*Sp_&quot;</span>, TestB, <span class="st">&quot;</span></span>
<span id="cb3-10"><a href="multiple-populations.html#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="st">  p1[3] &lt;- Prev1*(1-Se_&quot;</span>, TestA, <span class="st">&quot;)*Se_&quot;</span>, TestB, <span class="st">&quot; + (1-Prev1)*Sp_&quot;</span>, TestA, <span class="st">&quot;*(1-Sp_&quot;</span>, TestB, <span class="st">&quot;)</span></span>
<span id="cb3-11"><a href="multiple-populations.html#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="st">  p1[4] &lt;- Prev1*(1-Se_&quot;</span>, TestA, <span class="st">&quot;)*(1-Se_&quot;</span>, TestB, <span class="st">&quot;) + (1-Prev1)*Sp_&quot;</span>, TestA, <span class="st">&quot;*Sp_&quot;</span>, TestB, <span class="st">&quot;</span></span>
<span id="cb3-12"><a href="multiple-populations.html#cb3-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-13"><a href="multiple-populations.html#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="st">  #=== POPULATION 2 ===#  </span></span>
<span id="cb3-14"><a href="multiple-populations.html#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="st">  Pop2[1:4] ~ dmulti(p2[1:4], &quot;</span>,nPop2,<span class="st">&quot;)</span></span>
<span id="cb3-15"><a href="multiple-populations.html#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="st">  p2[1] &lt;- Prev2*Se_&quot;</span>, TestA, <span class="st">&quot;*Se_&quot;</span>, TestB, <span class="st">&quot; + (1-Prev2)*(1-Sp_&quot;</span>, TestA, <span class="st">&quot;)*(1-Sp_&quot;</span>, TestB, <span class="st">&quot;)</span></span>
<span id="cb3-16"><a href="multiple-populations.html#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="st">  p2[2] &lt;- Prev2*Se_&quot;</span>, TestA, <span class="st">&quot;*(1-Se_&quot;</span>, TestB, <span class="st">&quot;) + (1-Prev2)*(1-Sp_&quot;</span>, TestA, <span class="st">&quot;)*Sp_&quot;</span>, TestB, <span class="st">&quot;</span></span>
<span id="cb3-17"><a href="multiple-populations.html#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="st">  p2[3] &lt;- Prev2*(1-Se_&quot;</span>, TestA, <span class="st">&quot;)*Se_&quot;</span>, TestB, <span class="st">&quot; + (1-Prev2)*Sp_&quot;</span>, TestA, <span class="st">&quot;*(1-Sp_&quot;</span>, TestB, <span class="st">&quot;)</span></span>
<span id="cb3-18"><a href="multiple-populations.html#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="st">  p2[4] &lt;- Prev2*(1-Se_&quot;</span>, TestA, <span class="st">&quot;)*(1-Se_&quot;</span>, TestB, <span class="st">&quot;) + (1-Prev2)*Sp_&quot;</span>, TestA, <span class="st">&quot;*Sp_&quot;</span>, TestB, <span class="st">&quot;</span></span>
<span id="cb3-19"><a href="multiple-populations.html#cb3-19" aria-hidden="true" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb3-20"><a href="multiple-populations.html#cb3-20" aria-hidden="true" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb3-21"><a href="multiple-populations.html#cb3-21" aria-hidden="true" tabindex="-1"></a><span class="st">#=== PRIOR  ===#</span></span>
<span id="cb3-22"><a href="multiple-populations.html#cb3-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-23"><a href="multiple-populations.html#cb3-23" aria-hidden="true" tabindex="-1"></a><span class="st">  Prev1 ~ dbeta(&quot;</span>,Prev1.shapea,<span class="st">&quot;, &quot;</span>,Prev1.shapeb,<span class="st">&quot;)     ## Prior for Prevalence in population 1</span></span>
<span id="cb3-24"><a href="multiple-populations.html#cb3-24" aria-hidden="true" tabindex="-1"></a><span class="st">  Prev2 ~ dbeta(&quot;</span>,Prev2.shapea,<span class="st">&quot;, &quot;</span>,Prev2.shapeb,<span class="st">&quot;)     ## Prior for Prevalence in population 2</span></span>
<span id="cb3-25"><a href="multiple-populations.html#cb3-25" aria-hidden="true" tabindex="-1"></a><span class="st">  Se_&quot;</span>, TestA, <span class="st">&quot; ~ dbeta(&quot;</span>,Se.TestA.shapea,<span class="st">&quot;, &quot;</span>,Se.TestA.shapeb,<span class="st">&quot;)  ## Prior for Se of Test A</span></span>
<span id="cb3-26"><a href="multiple-populations.html#cb3-26" aria-hidden="true" tabindex="-1"></a><span class="st">  Sp_&quot;</span>, TestA, <span class="st">&quot; ~ dbeta(&quot;</span>,Sp.TestA.shapea,<span class="st">&quot;, &quot;</span>,Sp.TestA.shapeb,<span class="st">&quot;)  ## Prior for Sp of Test A</span></span>
<span id="cb3-27"><a href="multiple-populations.html#cb3-27" aria-hidden="true" tabindex="-1"></a><span class="st">  Se_&quot;</span>, TestB, <span class="st">&quot; ~ dbeta(&quot;</span>,Se.TestB.shapea,<span class="st">&quot;, &quot;</span>,Se.TestB.shapeb,<span class="st">&quot;)  ## Prior for Se of Test B</span></span>
<span id="cb3-28"><a href="multiple-populations.html#cb3-28" aria-hidden="true" tabindex="-1"></a><span class="st">  Sp_&quot;</span>, TestB, <span class="st">&quot; ~ dbeta(&quot;</span>,Sp.TestB.shapea,<span class="st">&quot;, &quot;</span>,Sp.TestB.shapeb,<span class="st">&quot;)  ## Prior for Sp of Test B</span></span>
<span id="cb3-29"><a href="multiple-populations.html#cb3-29" aria-hidden="true" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb3-30"><a href="multiple-populations.html#cb3-30" aria-hidden="true" tabindex="-1"></a><span class="st">}&quot;</span>)</span>
<span id="cb3-31"><a href="multiple-populations.html#cb3-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-32"><a href="multiple-populations.html#cb3-32" aria-hidden="true" tabindex="-1"></a><span class="co">#write as a text (.txt) file</span></span>
<span id="cb3-33"><a href="multiple-populations.html#cb3-33" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(model_2tests_2pop_indep, </span>
<span id="cb3-34"><a href="multiple-populations.html#cb3-34" aria-hidden="true" tabindex="-1"></a>            <span class="at">file=</span><span class="st">&quot;model_2tests_2pop_indep.txt&quot;</span>, </span>
<span id="cb3-35"><a href="multiple-populations.html#cb3-35" aria-hidden="true" tabindex="-1"></a>            <span class="at">quote=</span><span class="cn">FALSE</span>, </span>
<span id="cb3-36"><a href="multiple-populations.html#cb3-36" aria-hidden="true" tabindex="-1"></a>            <span class="at">sep=</span><span class="st">&quot;&quot;</span>, </span>
<span id="cb3-37"><a href="multiple-populations.html#cb3-37" aria-hidden="true" tabindex="-1"></a>            <span class="at">row.names=</span><span class="cn">FALSE</span>,</span>
<span id="cb3-38"><a href="multiple-populations.html#cb3-38" aria-hidden="true" tabindex="-1"></a>            <span class="at">col.names=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<p>With this code, you could, again, simply modify the labels for Test A and Test B, and the shape parameters for the prior distributions and the text file with the JAGS model will automatically be updated. Currently, it looks like this:</p>
<div class="figure">
<img src="Figures/model_2tests_2pop_indep.png" alt="" />
<p class="caption">Text file with the model for 2 independent diagnostic tests applied to two populations.</p>
</div>
<p>Again, we will need to provide a list of initial values (one per Markov chain) for all unknown parameters. Careful again, we now have two prevalence (<em>Prev1</em> and <em>Prev2</em>).</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="multiple-populations.html#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Initializing values for the parameters Prev, and the Ses and Sps of the two tests for the 3 chains.</span></span>
<span id="cb4-2"><a href="multiple-populations.html#cb4-2" aria-hidden="true" tabindex="-1"></a>inits <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">list</span>(<span class="at">Prev1=</span><span class="fl">0.50</span>,</span>
<span id="cb4-3"><a href="multiple-populations.html#cb4-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">Prev2=</span><span class="fl">0.50</span>,</span>
<span id="cb4-4"><a href="multiple-populations.html#cb4-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">Se_US=</span><span class="fl">0.90</span>,</span>
<span id="cb4-5"><a href="multiple-populations.html#cb4-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">Sp_US=</span><span class="fl">0.90</span>,</span>
<span id="cb4-6"><a href="multiple-populations.html#cb4-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">Se_PAG=</span><span class="fl">0.90</span>,</span>
<span id="cb4-7"><a href="multiple-populations.html#cb4-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">Sp_PAG=</span><span class="fl">0.90</span>),</span>
<span id="cb4-8"><a href="multiple-populations.html#cb4-8" aria-hidden="true" tabindex="-1"></a>              </span>
<span id="cb4-9"><a href="multiple-populations.html#cb4-9" aria-hidden="true" tabindex="-1"></a>              <span class="fu">list</span>(<span class="at">Prev1=</span><span class="fl">0.60</span>,</span>
<span id="cb4-10"><a href="multiple-populations.html#cb4-10" aria-hidden="true" tabindex="-1"></a>              <span class="at">Prev2=</span><span class="fl">0.60</span>,</span>
<span id="cb4-11"><a href="multiple-populations.html#cb4-11" aria-hidden="true" tabindex="-1"></a>              <span class="at">Se_US=</span><span class="fl">0.80</span>,</span>
<span id="cb4-12"><a href="multiple-populations.html#cb4-12" aria-hidden="true" tabindex="-1"></a>              <span class="at">Sp_US=</span><span class="fl">0.80</span>,</span>
<span id="cb4-13"><a href="multiple-populations.html#cb4-13" aria-hidden="true" tabindex="-1"></a>              <span class="at">Se_PAG=</span><span class="fl">0.80</span>,</span>
<span id="cb4-14"><a href="multiple-populations.html#cb4-14" aria-hidden="true" tabindex="-1"></a>              <span class="at">Sp_PAG=</span><span class="fl">0.80</span>),</span>
<span id="cb4-15"><a href="multiple-populations.html#cb4-15" aria-hidden="true" tabindex="-1"></a>              </span>
<span id="cb4-16"><a href="multiple-populations.html#cb4-16" aria-hidden="true" tabindex="-1"></a>              <span class="fu">list</span>(<span class="at">Prev1=</span><span class="fl">0.40</span>,</span>
<span id="cb4-17"><a href="multiple-populations.html#cb4-17" aria-hidden="true" tabindex="-1"></a>              <span class="at">Prev2=</span><span class="fl">0.40</span>,</span>
<span id="cb4-18"><a href="multiple-populations.html#cb4-18" aria-hidden="true" tabindex="-1"></a>              <span class="at">Se_US=</span><span class="fl">0.70</span>,</span>
<span id="cb4-19"><a href="multiple-populations.html#cb4-19" aria-hidden="true" tabindex="-1"></a>              <span class="at">Sp_US=</span><span class="fl">0.70</span>,</span>
<span id="cb4-20"><a href="multiple-populations.html#cb4-20" aria-hidden="true" tabindex="-1"></a>              <span class="at">Se_PAG=</span><span class="fl">0.70</span>,</span>
<span id="cb4-21"><a href="multiple-populations.html#cb4-21" aria-hidden="true" tabindex="-1"></a>              <span class="at">Sp_PAG=</span><span class="fl">0.70</span>)</span>
<span id="cb4-22"><a href="multiple-populations.html#cb4-22" aria-hidden="true" tabindex="-1"></a>              )</span></code></pre></div>
<p>We can run the model using <code>jags()</code> function as seen before.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="multiple-populations.html#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(R2jags)</span>
<span id="cb5-2"><a href="multiple-populations.html#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(coda)</span>
<span id="cb5-3"><a href="multiple-populations.html#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="multiple-populations.html#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Run the Bayesian model</span></span>
<span id="cb5-5"><a href="multiple-populations.html#cb5-5" aria-hidden="true" tabindex="-1"></a>bug.out <span class="ot">&lt;-</span> <span class="fu">jags</span>(<span class="at">data=</span>datalist,                             </span>
<span id="cb5-6"><a href="multiple-populations.html#cb5-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">model.file=</span><span class="st">&quot;model_2tests_2pop_indep.txt&quot;</span>,     </span>
<span id="cb5-7"><a href="multiple-populations.html#cb5-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">parameters.to.save=</span><span class="fu">c</span>(<span class="st">&quot;Prev1&quot;</span>, <span class="st">&quot;Prev2&quot;</span>, <span class="st">&quot;Se_US&quot;</span>, <span class="st">&quot;Sp_US&quot;</span>, <span class="st">&quot;Se_PAG&quot;</span>, <span class="st">&quot;Sp_PAG&quot;</span>),               </span>
<span id="cb5-8"><a href="multiple-populations.html#cb5-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">n.chains=</span><span class="dv">3</span>,                                 </span>
<span id="cb5-9"><a href="multiple-populations.html#cb5-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">inits=</span>inits,                                </span>
<span id="cb5-10"><a href="multiple-populations.html#cb5-10" aria-hidden="true" tabindex="-1"></a>               <span class="at">n.iter=</span><span class="dv">11000</span>,                                </span>
<span id="cb5-11"><a href="multiple-populations.html#cb5-11" aria-hidden="true" tabindex="-1"></a>               <span class="at">n.burnin=</span><span class="dv">1000</span>,                              </span>
<span id="cb5-12"><a href="multiple-populations.html#cb5-12" aria-hidden="true" tabindex="-1"></a>               <span class="at">n.thin=</span><span class="dv">1</span>,                                   </span>
<span id="cb5-13"><a href="multiple-populations.html#cb5-13" aria-hidden="true" tabindex="-1"></a>               <span class="at">DIC=</span><span class="cn">FALSE</span>)                                   </span></code></pre></div>
<pre><code>## Compiling model graph
##    Resolving undeclared variables
##    Allocating nodes
## Graph information:
##    Observed stochastic nodes: 2
##    Unobserved stochastic nodes: 6
##    Total graph size: 43
## 
## Initializing model</code></pre>
<p>Then we could produce the diagnostic plots, compute the ESS, and print out our results as we did previously (results not shown).</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="multiple-populations.html#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mcmcplots)</span>
<span id="cb7-2"><a href="multiple-populations.html#cb7-2" aria-hidden="true" tabindex="-1"></a>bug.mcmc <span class="ot">&lt;-</span> <span class="fu">as.mcmc</span>(bug.out)          </span>
<span id="cb7-3"><a href="multiple-populations.html#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmcplot</span>(bug.mcmc, <span class="at">title=</span><span class="st">&quot;Diagnostic plots&quot;</span>) </span>
<span id="cb7-4"><a href="multiple-populations.html#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="fu">effectiveSize</span>(bug.mcmc)</span>
<span id="cb7-5"><a href="multiple-populations.html#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(bug.out, <span class="at">digits.summary=</span><span class="dv">3</span>) </span></code></pre></div>

</div>
            </section>

          </div>
        </div>
      </div>
<a href="exercise-2---two-tests-one-population.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/06-Two_t_two_p.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
