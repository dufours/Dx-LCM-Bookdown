<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 2 Distributions | Bayesian latent class models for prevalence estimation and diagnostic test evaluation</title>
  <meta name="description" content="Chapitre 5" />
  <meta name="generator" content="bookdown 0.26 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 2 Distributions | Bayesian latent class models for prevalence estimation and diagnostic test evaluation" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Chapitre 5" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 2 Distributions | Bayesian latent class models for prevalence estimation and diagnostic test evaluation" />
  
  <meta name="twitter:description" content="Chapitre 5" />
  

<meta name="author" content="Simon Dufour and Juan Carlos Arango Sabogal" />


<meta name="date" content="2022-05-04" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="running-bayesian-models.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Bayesian latent class models</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> About this document</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#some-notation"><i class="fa fa-check"></i><b>1.1</b> Some notation</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="distributions.html"><a href="distributions.html"><i class="fa fa-check"></i><b>2</b> Distributions</a>
<ul>
<li class="chapter" data-level="2.1" data-path="distributions.html"><a href="distributions.html#prior-distributions"><i class="fa fa-check"></i><b>2.1</b> Prior distributions</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="distributions.html"><a href="distributions.html#normal-distribution"><i class="fa fa-check"></i><b>2.1.1</b> Normal distribution</a></li>
<li class="chapter" data-level="2.1.2" data-path="distributions.html"><a href="distributions.html#uniform-distribution"><i class="fa fa-check"></i><b>2.1.2</b> Uniform distribution</a></li>
<li class="chapter" data-level="2.1.3" data-path="distributions.html"><a href="distributions.html#beta-distribution"><i class="fa fa-check"></i><b>2.1.3</b> Beta distribution</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="distributions.html"><a href="distributions.html#distributions-for-likelihood-functions"><i class="fa fa-check"></i><b>2.2</b> Distributions for likelihood functions</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="distributions.html"><a href="distributions.html#binomial-distribution"><i class="fa fa-check"></i><b>2.2.1</b> Binomial distribution</a></li>
<li class="chapter" data-level="2.2.2" data-path="distributions.html"><a href="distributions.html#multinomial-distribution"><i class="fa fa-check"></i><b>2.2.2</b> Multinomial distribution</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="running-bayesian-models.html"><a href="running-bayesian-models.html"><i class="fa fa-check"></i><b>3</b> Running Bayesian models</a>
<ul>
<li class="chapter" data-level="3.1" data-path="running-bayesian-models.html"><a href="running-bayesian-models.html#the-data"><i class="fa fa-check"></i><b>3.1</b> The data</a></li>
<li class="chapter" data-level="3.2" data-path="running-bayesian-models.html"><a href="running-bayesian-models.html#the-model"><i class="fa fa-check"></i><b>3.2</b> The model</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="running-bayesian-models.html"><a href="running-bayesian-models.html#the-likelihood-function"><i class="fa fa-check"></i><b>3.2.1</b> The likelihood function</a></li>
<li class="chapter" data-level="3.2.2" data-path="running-bayesian-models.html"><a href="running-bayesian-models.html#priors-for-unkown-parameters"><i class="fa fa-check"></i><b>3.2.2</b> Priors for unkown parameters</a></li>
<li class="chapter" data-level="3.2.3" data-path="running-bayesian-models.html"><a href="running-bayesian-models.html#creating-the-jags-model"><i class="fa fa-check"></i><b>3.2.3</b> Creating the JAGS model</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="running-bayesian-models.html"><a href="running-bayesian-models.html#generating-initial-values"><i class="fa fa-check"></i><b>3.3</b> Generating initial values</a></li>
<li class="chapter" data-level="3.4" data-path="running-bayesian-models.html"><a href="running-bayesian-models.html#running-a-model-in-jags"><i class="fa fa-check"></i><b>3.4</b> Running a model in JAGS</a></li>
<li class="chapter" data-level="3.5" data-path="running-bayesian-models.html"><a href="running-bayesian-models.html#model-diagnostic"><i class="fa fa-check"></i><b>3.5</b> Model diagnostic</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="running-bayesian-models.html"><a href="running-bayesian-models.html#convergence-and-burn-in"><i class="fa fa-check"></i><b>3.5.1</b> Convergence and burn-in</a></li>
<li class="chapter" data-level="3.5.2" data-path="running-bayesian-models.html"><a href="running-bayesian-models.html#number-of-iterations"><i class="fa fa-check"></i><b>3.5.2</b> Number of iterations</a></li>
<li class="chapter" data-level="3.5.3" data-path="running-bayesian-models.html"><a href="running-bayesian-models.html#auto-correlation"><i class="fa fa-check"></i><b>3.5.3</b> Auto-correlation</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="running-bayesian-models.html"><a href="running-bayesian-models.html#getting-our-estimates"><i class="fa fa-check"></i><b>3.6</b> Getting our estimates</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="exercise-1---proportions.html"><a href="exercise-1---proportions.html"><i class="fa fa-check"></i><b>4</b> Exercise 1 - Proportions</a>
<ul>
<li class="chapter" data-level="4.1" data-path="exercise-1---proportions.html"><a href="exercise-1---proportions.html#data"><i class="fa fa-check"></i><b>4.1</b> Data</a></li>
<li class="chapter" data-level="4.2" data-path="exercise-1---proportions.html"><a href="exercise-1---proportions.html#questions"><i class="fa fa-check"></i><b>4.2</b> Questions</a></li>
<li class="chapter" data-level="4.3" data-path="exercise-1---proportions.html"><a href="exercise-1---proportions.html#answers"><i class="fa fa-check"></i><b>4.3</b> Answers</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="comparing-2-imperfect-tests.html"><a href="comparing-2-imperfect-tests.html"><i class="fa fa-check"></i><b>5</b> Comparing 2 imperfect tests</a>
<ul>
<li class="chapter" data-level="5.1" data-path="comparing-2-imperfect-tests.html"><a href="comparing-2-imperfect-tests.html#lcm---conditional-independence"><i class="fa fa-check"></i><b>5.1</b> LCM - Conditional independence</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Bayesian latent class models for prevalence estimation and diagnostic test evaluation</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="distributions" class="section level1 hasAnchor" number="2">
<h1><span class="header-section-number">Chapter 2</span> Distributions<a href="distributions.html#distributions" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>When using latent class models (LCM) to estimate disease prevalence or diagnostic test accuracy, we will need to use various distributions. There are two situations where we will use distributions:</p>
<ol style="list-style-type: decimal">
<li>as prior distribution to describe our <i>a priori</i> knowledge on a given unknown parameter.<br />
</li>
<li>as a part of the likelihood function that will be used to linked observed data with unknown parameters.</li>
</ol>
<p>Some distributions will more often be used for the first objective, others will mainly be used for the latter objective. In he following sections, we will cover the most usefull distributions.</p>
<div id="prior-distributions" class="section level2 hasAnchor" number="2.1">
<h2><span class="header-section-number">2.1</span> Prior distributions<a href="distributions.html#prior-distributions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>One of the first thing that you will need for any Bayesian analysis is a way to generate and visualize a prior distribution corresponding to some scientific knowledge that you have about an unknown parameter. Generally, you will use information such as the mean and variance or the mode and the 2.5th (or 97.5th) percentile to find a corresponding distribution. You will use various distributions. Here is a list of the most important ones, we will give more details on each of them in the following sections:</p>
<p><strong>- Normal distribution:</strong> defined by a mean (mu) and its standard deviation (SD) or variance (tau). In some packages and software, <code>rjags</code> and JAGS for instance, the inverse of the variance (1/tau) is used to specify a given normal distribution.<br />
<strong>Notation: dNorm(mu, 1/tau)</strong></p>
<p><strong>- Uniform distribution:</strong> defined by a minimum (min) and maximum (max).<br />
<strong>Notation: dUnif(min, max)</strong></p>
<p><strong>- Beta distribution:</strong> bounded between 0 and 1, beta distributions are defined by two shape parameters (a) and (b).<br />
<strong>Notation: dBeta(a, b)</strong></p>
<div id="normal-distribution" class="section level3 hasAnchor" number="2.1.1">
<h3><span class="header-section-number">2.1.1</span> Normal distribution<a href="distributions.html#normal-distribution" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>dnorm()</code> function can be used to generate a given Normal distribution and the <code>curve()</code> function can be used to visualize the generated distribution. These functions are already part of <code>R</code>, there is no need to upload a <code>R</code> package.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="distributions.html#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dnorm</span>(x, <span class="at">mean=</span><span class="fl">2.0</span>, <span class="at">sd=</span><span class="fl">0.5</span>),                                    <span class="co"># I indicate mean and SD of the distribution</span></span>
<span id="cb5-2"><a href="distributions.html#cb5-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">from=</span><span class="sc">-</span><span class="dv">2</span>, <span class="at">to=</span><span class="dv">7</span>,                                                 <span class="co"># I indicate limits for the plot</span></span>
<span id="cb5-3"><a href="distributions.html#cb5-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">main=</span><span class="st">&quot;Normal distribution with mean of 2.0 and SD of 0.5&quot;</span>,     <span class="co">#Adding a title</span></span>
<span id="cb5-4"><a href="distributions.html#cb5-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">xlab =</span> <span class="st">&quot;Value&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Density&quot;</span>)                              <span class="co">#Adding titles for axes</span></span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-4"></span>
<img src="_main_files/figure-html/unnamed-chunk-4-1.png" alt="Density curve of a Normal distribution." width="672" />
<p class="caption">
Figure 2.1: Density curve of a Normal distribution.
</p>
</div>
<p>Note that a Normal distribution with mean of zero and a very large SD provides very little information. Such distribution would be referred to as a <strong>uniform or flat distribution</strong> (A.K.A.; a vague distribution).</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="distributions.html#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dnorm</span>(x, <span class="at">mean=</span><span class="fl">0.0</span>, <span class="at">sd=</span><span class="dv">10000000000</span>),                                    </span>
<span id="cb6-2"><a href="distributions.html#cb6-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">from=</span><span class="sc">-</span><span class="dv">100</span>, <span class="at">to=</span><span class="dv">100</span>,                                                 </span>
<span id="cb6-3"><a href="distributions.html#cb6-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">main=</span><span class="st">&quot;A flat Normal distribution&quot;</span>,     </span>
<span id="cb6-4"><a href="distributions.html#cb6-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">xlab =</span> <span class="st">&quot;Value&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Density&quot;</span>)                              </span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-5"></span>
<img src="_main_files/figure-html/unnamed-chunk-5-1.png" alt="Density curve of a flat Normal distribution." width="672" />
<p class="caption">
Figure 2.2: Density curve of a flat Normal distribution.
</p>
</div>
</div>
<div id="uniform-distribution" class="section level3 hasAnchor" number="2.1.2">
<h3><span class="header-section-number">2.1.2</span> Uniform distribution<a href="distributions.html#uniform-distribution" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In the same manner, we could visualize an uniform distribution using the <code>dunif()</code> function. In the following example, we assumed that any values between -5.0 and 5.0 are equally probable.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="distributions.html#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dunif</span>(x, <span class="at">min=</span><span class="sc">-</span><span class="fl">5.0</span>, <span class="at">max=</span><span class="fl">5.0</span>),                                    </span>
<span id="cb7-2"><a href="distributions.html#cb7-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">from=</span><span class="sc">-</span><span class="dv">10</span>, <span class="at">to=</span><span class="dv">10</span>,                                                 </span>
<span id="cb7-3"><a href="distributions.html#cb7-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">main=</span><span class="st">&quot;Uniform distribution with -5.0 and 5.0 limits&quot;</span>,    </span>
<span id="cb7-4"><a href="distributions.html#cb7-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">xlab =</span> <span class="st">&quot;Value&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Density&quot;</span>)                              </span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-6"></span>
<img src="_main_files/figure-html/unnamed-chunk-6-1.png" alt="Density curve of an Uniform distribution." width="672" />
<p class="caption">
Figure 2.3: Density curve of an Uniform distribution.
</p>
</div>
</div>
<div id="beta-distribution" class="section level3 hasAnchor" number="2.1.3">
<h3><span class="header-section-number">2.1.3</span> Beta distribution<a href="distributions.html#beta-distribution" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Beta distributions are another type of distributions that will specifically be used for parameters that are proportions (i.e., bounded between 0.0 and 1.0). <b>For this specific workshop, they will be very handy, since a sensitivity, specificity, or a prevalence are all proportions </b>. The <code>epi.betabuster()</code> function from the <code>epiR</code> library can be used to define a given prior distribution based on previous knowledge. When you use the <code>epi.betabuster()</code> function, it creates a new <code>R</code> object containing different elements. Among these, one element will be named <em>shape1</em> and another <em>shape2</em>. These correspond to the a and b shape parameters of the corresponding Beta distribution.</p>
<p>For instance we may know that the most likely value for the sensitivity of a given test is 0.85 and that we are 97.5% certain that it is greater than 0.75. With these values, we will be able to find the a and b shape parameters of the corresponding Beta distribution.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="distributions.html#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(epiR) </span>
<span id="cb8-2"><a href="distributions.html#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="distributions.html#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Sensitivity of a test as Mode=0.85, and we are 97.5% sure &gt;0.75 </span></span>
<span id="cb8-4"><a href="distributions.html#cb8-4" aria-hidden="true" tabindex="-1"></a>rval <span class="ot">&lt;-</span> <span class="fu">epi.betabuster</span>(<span class="at">mode=</span><span class="fl">0.85</span>, <span class="at">conf=</span><span class="fl">0.975</span>, <span class="at">greaterthan=</span>T, <span class="at">x=</span><span class="fl">0.75</span>)  <span class="co"># I create a new object named rval</span></span>
<span id="cb8-5"><a href="distributions.html#cb8-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-6"><a href="distributions.html#cb8-6" aria-hidden="true" tabindex="-1"></a>rval<span class="sc">$</span>shape1                <span class="co">#View the a shape parameter in rval</span></span></code></pre></div>
<pre><code>## [1] 62.661</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="distributions.html#cb10-1" aria-hidden="true" tabindex="-1"></a>rval<span class="sc">$</span>shape2                <span class="co">#View the b shape parameter in rval  </span></span></code></pre></div>
<pre><code>## [1] 11.88135</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="distributions.html#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plot the prior distribution</span></span>
<span id="cb12-2"><a href="distributions.html#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dbeta</span>(x, <span class="at">shape1=</span>rval<span class="sc">$</span>shape1, <span class="at">shape2=</span>rval<span class="sc">$</span>shape2), <span class="at">from=</span><span class="dv">0</span>, <span class="at">to=</span><span class="dv">1</span>, </span>
<span id="cb12-3"><a href="distributions.html#cb12-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">main=</span><span class="st">&quot;Prior for test&#39;s sensitivity&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;Proportion&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Density&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-7"></span>
<img src="_main_files/figure-html/unnamed-chunk-7-1.png" alt="Density curve of a Beta distribution for a test sensitivity." width="672" />
<p class="caption">
Figure 2.4: Density curve of a Beta distribution for a test sensitivity.
</p>
</div>
<p>Note that a dBeta(1.0, 1.0) is a uniform beta distribution.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="distributions.html#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plot the prior distribution</span></span>
<span id="cb13-2"><a href="distributions.html#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dbeta</span>(x, <span class="at">shape1=</span><span class="fl">1.0</span>, <span class="at">shape2=</span><span class="fl">1.0</span>), <span class="at">from=</span><span class="dv">0</span>, <span class="at">to=</span><span class="dv">1</span>, </span>
<span id="cb13-3"><a href="distributions.html#cb13-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">main=</span><span class="st">&quot;A Beta(1.0, 1.0) or flat distribution&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;Proportion&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Density&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-8"></span>
<img src="_main_files/figure-html/unnamed-chunk-8-1.png" alt="Density curve of a Beta(1.0, 1.0) distribution." width="672" />
<p class="caption">
Figure 2.5: Density curve of a Beta(1.0, 1.0) distribution.
</p>
</div>
</div>
</div>
<div id="distributions-for-likelihood-functions" class="section level2 hasAnchor" number="2.2">
<h2><span class="header-section-number">2.2</span> Distributions for likelihood functions<a href="distributions.html#distributions-for-likelihood-functions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In many situations, a distribution will be used as a part of the likelihood function to link observed data to unknown parameters. The ones we will most frequently used here are:</p>
<p><strong>- Binomial distribution:</strong> For variables that can take the value 0 or 1. Binomial distributions are defined by a probability, P, which is the probability that the variable takes the value 1, and a number of “trials”, n.<br />
<strong>Notation: dBin(P, n)</strong></p>
<p><strong>- Multinomial distribution:</strong> made up of a number of probabilities, all bounded between 0 and 1, and that, together, will sum up to 1. Multinomial distributions are defined by k probabilities (P1, P2, …, Pk) and a number of observation (n).<br />
<strong>Notation: dmulti(P[1:k], n)</strong></p>
<div id="binomial-distribution" class="section level3 hasAnchor" number="2.2.1">
<h3><span class="header-section-number">2.2.1</span> Binomial distribution<a href="distributions.html#binomial-distribution" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>If we have a variable that can take only two values, healthy or diseased (0 or 1), we can estimates an unknown parameter such as the proportion (P) of diseased individuals (i.e., the disease prevalence), based on the observed data (a number of positive individuals, T AND a total number of individuals, n). For instance, if we had 30 diseased (T = 30) out of 100 tested individuals (n=100) we could estimate the unknown parameter P using this very simple likelihood function:</p>
<p><span class="math inline">\(T \sim dbin(P, n)\)</span></p>
</div>
<div id="multinomial-distribution" class="section level3 hasAnchor" number="2.2.2">
<h3><span class="header-section-number">2.2.2</span> Multinomial distribution<a href="distributions.html#multinomial-distribution" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A last type of distribution that we will use in our LCM is the multinomial distribution. When an outcome is categorical with &gt;2 categories, we could use a multinomial distribution to describe the probability that an individual has the value “A”, or “B”, or “C”, etc. In our context, the main application of this distribution will be for describing the combined results of two (or more than two) diagnostic tests. For instance, if we cross-tabulate the results of Test A and Test B, we have four potential outcomes:</p>
<p>-Test A+ and Test B+ (lets call n1 the number of individuals in that cell and P1 the probability of falling in that cell)<br />
-Test A+ and Test B- (n2 and P2)<br />
-Test A- and Test B+ (n3 and P3)<br />
-Test A- and Test B- (n4 and P4)</p>
<p>We can illustrate this as follow:</p>
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-10">Table 2.1: </span>Cross-classified results from two diagnostic tests
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
Test A+
</th>
<th style="text-align:left;">
Test A-
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Test B+
</td>
<td style="text-align:left;">
n1
</td>
<td style="text-align:left;">
n3
</td>
</tr>
<tr>
<td style="text-align:left;">
Test B-
</td>
<td style="text-align:left;">
n2
</td>
<td style="text-align:left;">
n4
</td>
</tr>
</tbody>
</table>
<p>Thus we could describe the probabilities (P1 to P4) of an individual falling into one of these cells of the 2x2 table as a multinomial distribution. In this specific case, we would say that the combined results of the 2 tests (n1 to n4) and the total number of individual tested (n), which are the observed data, are linked as follow to the 4 probabilities (P1 to P4; the unknown parameters):</p>
<p><span class="math inline">\(n[1:4] \sim dmulti(P[1:4], n)\)</span></p>
<p>Which means: the values of n1 (or n2, n3, or n4) is determined by the probability of falling into the “Test A+ and Test B+” cell, which is P1 (or P2, P3, or P4 for the other cells), and by the total number of individuals tested (n). Nothing too surprising here… If I have a probability of 0.30 to fall in a given cell, and I have tested 100 individuals, I should find 30 individuals in that cell. Wow! Still, the multinomial distribution is nice because it will ensure that all our probabilities (P1 to P4) will sum up to exactly 1.0.</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="running-bayesian-models.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/01-Distributions.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
