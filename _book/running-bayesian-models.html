<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Running Bayesian models | Bayesian latent class models for prevalence estimation and diagnostic test evaluation</title>
  <meta name="description" content="Chapitre 5" />
  <meta name="generator" content="bookdown 0.26 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Running Bayesian models | Bayesian latent class models for prevalence estimation and diagnostic test evaluation" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Chapitre 5" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Running Bayesian models | Bayesian latent class models for prevalence estimation and diagnostic test evaluation" />
  
  <meta name="twitter:description" content="Chapitre 5" />
  

<meta name="author" content="Simon Dufour and Juan Carlos Arango Sabogal" />


<meta name="date" content="2022-05-04" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="distributions.html"/>
<link rel="next" href="exercise-1---proportions.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Bayesian latent class models</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> About this document</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#some-notation"><i class="fa fa-check"></i><b>1.1</b> Some notation</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="distributions.html"><a href="distributions.html"><i class="fa fa-check"></i><b>2</b> Distributions</a>
<ul>
<li class="chapter" data-level="2.1" data-path="distributions.html"><a href="distributions.html#prior-distributions"><i class="fa fa-check"></i><b>2.1</b> Prior distributions</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="distributions.html"><a href="distributions.html#normal-distribution"><i class="fa fa-check"></i><b>2.1.1</b> Normal distribution</a></li>
<li class="chapter" data-level="2.1.2" data-path="distributions.html"><a href="distributions.html#uniform-distribution"><i class="fa fa-check"></i><b>2.1.2</b> Uniform distribution</a></li>
<li class="chapter" data-level="2.1.3" data-path="distributions.html"><a href="distributions.html#beta-distribution"><i class="fa fa-check"></i><b>2.1.3</b> Beta distribution</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="distributions.html"><a href="distributions.html#distributions-for-likelihood-functions"><i class="fa fa-check"></i><b>2.2</b> Distributions for likelihood functions</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="distributions.html"><a href="distributions.html#binomial-distribution"><i class="fa fa-check"></i><b>2.2.1</b> Binomial distribution</a></li>
<li class="chapter" data-level="2.2.2" data-path="distributions.html"><a href="distributions.html#multinomial-distribution"><i class="fa fa-check"></i><b>2.2.2</b> Multinomial distribution</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="running-bayesian-models.html"><a href="running-bayesian-models.html"><i class="fa fa-check"></i><b>3</b> Running Bayesian models</a>
<ul>
<li class="chapter" data-level="3.1" data-path="running-bayesian-models.html"><a href="running-bayesian-models.html#the-data"><i class="fa fa-check"></i><b>3.1</b> The data</a></li>
<li class="chapter" data-level="3.2" data-path="running-bayesian-models.html"><a href="running-bayesian-models.html#the-model"><i class="fa fa-check"></i><b>3.2</b> The model</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="running-bayesian-models.html"><a href="running-bayesian-models.html#the-likelihood-function"><i class="fa fa-check"></i><b>3.2.1</b> The likelihood function</a></li>
<li class="chapter" data-level="3.2.2" data-path="running-bayesian-models.html"><a href="running-bayesian-models.html#priors-for-unkown-parameters"><i class="fa fa-check"></i><b>3.2.2</b> Priors for unkown parameters</a></li>
<li class="chapter" data-level="3.2.3" data-path="running-bayesian-models.html"><a href="running-bayesian-models.html#creating-the-jags-model"><i class="fa fa-check"></i><b>3.2.3</b> Creating the JAGS model</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="running-bayesian-models.html"><a href="running-bayesian-models.html#generating-initial-values"><i class="fa fa-check"></i><b>3.3</b> Generating initial values</a></li>
<li class="chapter" data-level="3.4" data-path="running-bayesian-models.html"><a href="running-bayesian-models.html#running-a-model-in-jags"><i class="fa fa-check"></i><b>3.4</b> Running a model in JAGS</a></li>
<li class="chapter" data-level="3.5" data-path="running-bayesian-models.html"><a href="running-bayesian-models.html#model-diagnostic"><i class="fa fa-check"></i><b>3.5</b> Model diagnostic</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="running-bayesian-models.html"><a href="running-bayesian-models.html#convergence-and-burn-in"><i class="fa fa-check"></i><b>3.5.1</b> Convergence and burn-in</a></li>
<li class="chapter" data-level="3.5.2" data-path="running-bayesian-models.html"><a href="running-bayesian-models.html#number-of-iterations"><i class="fa fa-check"></i><b>3.5.2</b> Number of iterations</a></li>
<li class="chapter" data-level="3.5.3" data-path="running-bayesian-models.html"><a href="running-bayesian-models.html#auto-correlation"><i class="fa fa-check"></i><b>3.5.3</b> Auto-correlation</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="running-bayesian-models.html"><a href="running-bayesian-models.html#getting-our-estimates"><i class="fa fa-check"></i><b>3.6</b> Getting our estimates</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="exercise-1---proportions.html"><a href="exercise-1---proportions.html"><i class="fa fa-check"></i><b>4</b> Exercise 1 - Proportions</a>
<ul>
<li class="chapter" data-level="4.1" data-path="exercise-1---proportions.html"><a href="exercise-1---proportions.html#data"><i class="fa fa-check"></i><b>4.1</b> Data</a></li>
<li class="chapter" data-level="4.2" data-path="exercise-1---proportions.html"><a href="exercise-1---proportions.html#questions"><i class="fa fa-check"></i><b>4.2</b> Questions</a></li>
<li class="chapter" data-level="4.3" data-path="exercise-1---proportions.html"><a href="exercise-1---proportions.html#answers"><i class="fa fa-check"></i><b>4.3</b> Answers</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="comparing-2-imperfect-tests.html"><a href="comparing-2-imperfect-tests.html"><i class="fa fa-check"></i><b>5</b> Comparing 2 imperfect tests</a>
<ul>
<li class="chapter" data-level="5.1" data-path="comparing-2-imperfect-tests.html"><a href="comparing-2-imperfect-tests.html#lcm---conditional-independence"><i class="fa fa-check"></i><b>5.1</b> LCM - Conditional independence</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Bayesian latent class models for prevalence estimation and diagnostic test evaluation</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="running-bayesian-models" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">Chapter 3</span> Running Bayesian models<a href="running-bayesian-models.html#running-bayesian-models" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Different software and <code>R</code> packages can be used to run Bayesian models. Whether it is a LCM or a more conventional regression model is not very important at this stage. In this document we will mainly use a software called JAGS and the <code>R2jags</code> package. So, if not already done, you will have to download JAGS <a href="https://sourceforge.net/projects/mcmc-jags/files/">here</a> and install it on your computer. Once installed, we will be able to use <code>R2jags</code> to operate JAGS through <code>R</code>.</p>
<p>Basically, to run any Bayesian model, we will always need the same three things:</p>
<ul>
<li>Data</li>
<li>A model containing:
<ul>
<li>A likelihood function linking observed data to unknown parameters</li>
<li>A prior distribution for each unknown parameter</li>
</ul></li>
<li>An initial value for each unknown parameters to start the Markov chains
<ul>
<li>These values can also be generated randomly by the software, but specifying them will improve reproducibility</li>
</ul></li>
</ul>
<div id="the-data" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> The data<a href="running-bayesian-models.html#the-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This is the easy part. If we were to run, for instance, a “conventional” regression analysis, we would have to import in <code>R</code> a complete dataset (e.g., a CSV file) with a row for each observation and a column for each variable. However, when using LCM to estimate a disease prevalence or diagnostic accuracy, the dataset is simply made up of the number of individuals in each category. For instance, for estimating a simple prevalence (<em>Prev</em>), we could have 30 individuals that tested positive (variable <em>T</em>) out of a total of 100 individuals (variable <em>n</em>). In such case, the dataset could be created as follow:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="running-bayesian-models.html#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Creating a dataset</span></span>
<span id="cb14-2"><a href="running-bayesian-models.html#cb14-2" aria-hidden="true" tabindex="-1"></a>datalist <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">T=</span><span class="dv">30</span>, <span class="at">n=</span><span class="dv">100</span>)</span></code></pre></div>
<p>If you want to check that it works, you could ask to see this new <code>R</code> object.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="running-bayesian-models.html#cb15-1" aria-hidden="true" tabindex="-1"></a>datalist</span></code></pre></div>
<pre><code>## $T
## [1] 30
## 
## $n
## [1] 100</code></pre>
</div>
<div id="the-model" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> The model<a href="running-bayesian-models.html#the-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="the-likelihood-function" class="section level3 hasAnchor" number="3.2.1">
<h3><span class="header-section-number">3.2.1</span> The likelihood function<a href="running-bayesian-models.html#the-likelihood-function" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Lets start with a simple example, estimating a single proportion. For estimating a proportion we could describe the likelihood function linking unknown parameters to observed data as follow:</p>
<p><span class="math inline">\(T \sim dbin(Prev, n)\)</span></p>
<p>In other words: the disease prevalence (<em>Prev</em>), an unknown parameter, can be linked to the observed number of positive individuals (<em>T</em>) and the total number of tested individual (<em>n</em>) through the binomial function.</p>
<p>In this case, the values of <em>T</em> and <em>n</em> are the observed data and <em>Prev</em> is the only unknown parameter.</p>
</div>
<div id="priors-for-unkown-parameters" class="section level3 hasAnchor" number="3.2.2">
<h3><span class="header-section-number">3.2.2</span> Priors for unkown parameters<a href="running-bayesian-models.html#priors-for-unkown-parameters" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We will have to specify a prior distribution for each unknown parameter (using the <span class="math inline">\(\sim\)</span> sign).</p>
<p>In the preceding example, we only have one unkown parameter, <em>Prev</em>, which is a proportion. Theoretically such parameter could take values from 0 to 1, so a beta distribution would be one way to describe its prior distribution. We could use the <code>epi.betabuster()</code> function from the <code>epiR</code> library to define a given beta distribution based on previous knowledge, as described in the preceding sections. Moreover, if we want to use a flat prior, we could simply choose the value 1.0 for the a and b shape parameters.</p>
<p>In the following code, I am creating <code>R</code> objects for a and b for <em>Prev</em> beta prior distributions.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="running-bayesian-models.html#cb17-1" aria-hidden="true" tabindex="-1"></a>Prev.shapea <span class="ot">&lt;-</span> <span class="dv">1</span>         <span class="co">#a shape parameter for Prev    </span></span>
<span id="cb17-2"><a href="running-bayesian-models.html#cb17-2" aria-hidden="true" tabindex="-1"></a>Prev.shapeb <span class="ot">&lt;-</span> <span class="dv">1</span>         <span class="co">#b shape parameter for Prev </span></span></code></pre></div>
<p>With informative priors, for instance, if we know from the literature that the prevalence is expected to be 0.25 with 95CI of (0.20, 0.30), we could instead use the following code and assign these values to <em>Prev.shapea</em> and <em>Prev.shapeb</em>:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="running-bayesian-models.html#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(epiR) </span>
<span id="cb18-2"><a href="running-bayesian-models.html#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="running-bayesian-models.html#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Prevalence as Mode=0.25, and we are 97.5% sure &gt;0.20 </span></span>
<span id="cb18-4"><a href="running-bayesian-models.html#cb18-4" aria-hidden="true" tabindex="-1"></a>rval <span class="ot">&lt;-</span> <span class="fu">epi.betabuster</span>(<span class="at">mode=</span><span class="fl">0.25</span>, <span class="at">conf=</span><span class="fl">0.975</span>, <span class="at">greaterthan=</span>T, <span class="at">x=</span><span class="fl">0.20</span>)  <span class="co"># I create a new object named rval</span></span>
<span id="cb18-5"><a href="running-bayesian-models.html#cb18-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-6"><a href="running-bayesian-models.html#cb18-6" aria-hidden="true" tabindex="-1"></a>rval<span class="sc">$</span>shape1                <span class="co">#View the a shape parameter in rval</span></span></code></pre></div>
<pre><code>## [1] 62.356</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="running-bayesian-models.html#cb20-1" aria-hidden="true" tabindex="-1"></a>rval<span class="sc">$</span>shape2                <span class="co">#View the b shape parameter in rval</span></span></code></pre></div>
<pre><code>## [1] 185.068</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="running-bayesian-models.html#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co">#I left them as comments, but the two lines below would be used to assign the generated values for later usage</span></span>
<span id="cb22-2"><a href="running-bayesian-models.html#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Prev.shapea &lt;- rval$shape1</span></span>
<span id="cb22-3"><a href="running-bayesian-models.html#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Prev.shapeb &lt;- rval$shape2</span></span></code></pre></div>
</div>
<div id="creating-the-jags-model" class="section level3 hasAnchor" number="3.2.3">
<h3><span class="header-section-number">3.2.3</span> Creating the JAGS model<a href="running-bayesian-models.html#creating-the-jags-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Our Bayesian model has to be presented to JAGS as a text file (i.e., a .txt document). To create this text file, we will use the <code>paste0()</code> function to write down the model and then the <code>write.table()</code> function to save it as a .txt file.</p>
<p><strong>An interesting feature of the <code>paste0()</code> function is the possibility to include <code>R</code> objects in the text.</strong> For instance, you may want to have a general model that will not be modified, but to change the values used to describe the priors. Within your <code>paste0()</code> function you could call these “external” values. Thus, you just have to change the value of the <code>R</code> object that your model is using, rather than rewriting a new model. For instance, we just created these two <code>R</code> objects called <em>Prev.shapea</em> and <em>Prev.shapeb</em> (which were the a and b shape parameters for the prior distribution of our proportion <em>Prev</em>). To describe our prior distribution, we can ignore this previous work that we have done and directly create a short text as follow:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="running-bayesian-models.html#cb23-1" aria-hidden="true" tabindex="-1"></a>text1 <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;Prev ~ dbeta(1, 1)&quot;</span>)       <span class="co">#Creating a short text named &quot;text1&quot;</span></span>
<span id="cb23-2"><a href="running-bayesian-models.html#cb23-2" aria-hidden="true" tabindex="-1"></a>text1                                       <span class="co">#Asking to see the text1 object</span></span></code></pre></div>
<pre><code>## [1] &quot;Prev ~ dbeta(1, 1)&quot;</code></pre>
<p>However, if the same model is to be applied later with a different prior distribution, it may be more convenient to leave the a and b shape parameters as <code>R</code> objects. Thus, if we change the prior distribution and run the script again, you would run the entire analyses with the new distribution.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="running-bayesian-models.html#cb25-1" aria-hidden="true" tabindex="-1"></a>text2 <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;Prev ~ dbeta(&quot;</span>,Prev.shapea,<span class="st">&quot;, &quot;</span>,Prev.shapeb,<span class="st">&quot;)&quot;</span>)            <span class="co">#Creating a short text named &quot;text2&quot; and containing other already created R objects</span></span>
<span id="cb25-2"><a href="running-bayesian-models.html#cb25-2" aria-hidden="true" tabindex="-1"></a>text2                                                                        <span class="co">#Asking to see the text2 object</span></span></code></pre></div>
<pre><code>## [1] &quot;Prev ~ dbeta(1, 1)&quot;</code></pre>
<p>When using <code>paste0()</code>, any text appearing between sets of quotations marks and within commas (i.e.,” “,bla-bla,” “) will be considered as a <code>R</code> object that need to be included between the pieces of text included in each quotation. Thus, later, I could just change the values for <em>Prev.shapea</em> and <em>Prev.shapeb</em> and my model will be automatically modified.</p>
<p><strong>Some important notes about the text file containing the model before we start with <code>R2jags</code>:</strong></p>
<ul>
<li><p>JAGS is expecting to see the word “model” followed by curly brackets { }. The curly brackets will contain the likelihood function AND the priors.</p></li>
<li><p>Similarly to <code>R</code>, any line starting with a # will be ignored (these are comments).</p></li>
<li><p>Similarly to <code>R</code>, &lt;- means equal.</p></li>
<li><p>The ~ symbol means “follow a distribution”.</p></li>
<li><p>Similarly to <code>R</code>, JAGS is case sensitive (i.e., <em>P</em> does not equal <em>p</em>).</p></li>
<li><p>Loops can be used with keyword “for” followed by curly brackets.</p></li>
<li><p>Array can be indicated using squared brackets [ ].</p></li>
</ul>
<p>In the example below, I create a <code>R</code> object called <em>model_single_prop</em> using the <code>paste0()</code> function and then save it as a text file using the <code>write.table()</code> function. We will check this text file below and then explain the code for the model.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="running-bayesian-models.html#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify the model</span></span>
<span id="cb27-2"><a href="running-bayesian-models.html#cb27-2" aria-hidden="true" tabindex="-1"></a>model_single_prop <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;model{</span></span>
<span id="cb27-3"><a href="running-bayesian-models.html#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="running-bayesian-models.html#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="st">#=== LIKELIHOOD ===#</span></span>
<span id="cb27-5"><a href="running-bayesian-models.html#cb27-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-6"><a href="running-bayesian-models.html#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="st">  T ~ dbin(Prev, n)</span></span>
<span id="cb27-7"><a href="running-bayesian-models.html#cb27-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-8"><a href="running-bayesian-models.html#cb27-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-9"><a href="running-bayesian-models.html#cb27-9" aria-hidden="true" tabindex="-1"></a><span class="st">#=== PRIOR  ===#</span></span>
<span id="cb27-10"><a href="running-bayesian-models.html#cb27-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-11"><a href="running-bayesian-models.html#cb27-11" aria-hidden="true" tabindex="-1"></a><span class="st">  Prev ~ dbeta(&quot;</span>,Prev.shapea,<span class="st">&quot;, &quot;</span>,Prev.shapeb,<span class="st">&quot;)    ## Prior for Prev</span></span>
<span id="cb27-12"><a href="running-bayesian-models.html#cb27-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-13"><a href="running-bayesian-models.html#cb27-13" aria-hidden="true" tabindex="-1"></a><span class="st">}&quot;</span>)</span>
<span id="cb27-14"><a href="running-bayesian-models.html#cb27-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-15"><a href="running-bayesian-models.html#cb27-15" aria-hidden="true" tabindex="-1"></a><span class="co">#write as a text (.txt) file</span></span>
<span id="cb27-16"><a href="running-bayesian-models.html#cb27-16" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(model_single_prop, </span>
<span id="cb27-17"><a href="running-bayesian-models.html#cb27-17" aria-hidden="true" tabindex="-1"></a>            <span class="at">file=</span><span class="st">&quot;model_single_prop.txt&quot;</span>, </span>
<span id="cb27-18"><a href="running-bayesian-models.html#cb27-18" aria-hidden="true" tabindex="-1"></a>            <span class="at">quote=</span><span class="cn">FALSE</span>, </span>
<span id="cb27-19"><a href="running-bayesian-models.html#cb27-19" aria-hidden="true" tabindex="-1"></a>            <span class="at">sep=</span><span class="st">&quot;&quot;</span>, </span>
<span id="cb27-20"><a href="running-bayesian-models.html#cb27-20" aria-hidden="true" tabindex="-1"></a>            <span class="at">row.names=</span><span class="cn">FALSE</span>,</span>
<span id="cb27-21"><a href="running-bayesian-models.html#cb27-21" aria-hidden="true" tabindex="-1"></a>             <span class="at">col.names=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<p>Here is a snapshot of the final result (i.e., the text file):</p>
<div class="figure">
<img src="Figures/Model_single_prop.png" alt="" />
<p class="caption">Text file with the model for estimating a single proportion.</p>
</div>
</div>
</div>
<div id="generating-initial-values" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> Generating initial values<a href="running-bayesian-models.html#generating-initial-values" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The initial value is the first value where each Markov chain will start.<br />
- You have to specify one initial value for each unknown parameter in the model.<br />
- If you decide to ran three Markov chains, you will need three different sets of initial values.</p>
<p>For instance, in our preceding example we have one unknown parameter (<em>Prev</em>). If we were to run three Markov chains, we could generate three sets of initial values for this parameter as follow. Of course, the chosen values could be changed. In the case of a proportion, you can specify any value between 0 and 1.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="running-bayesian-models.html#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Initializing values for the parameter &quot;Prev&quot; for the 3 chains</span></span>
<span id="cb28-2"><a href="running-bayesian-models.html#cb28-2" aria-hidden="true" tabindex="-1"></a>inits <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb28-3"><a href="running-bayesian-models.html#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">Prev=</span><span class="fl">0.10</span>),</span>
<span id="cb28-4"><a href="running-bayesian-models.html#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">Prev=</span><span class="fl">0.50</span>),</span>
<span id="cb28-5"><a href="running-bayesian-models.html#cb28-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">Prev=</span><span class="fl">0.90</span>)</span>
<span id="cb28-6"><a href="running-bayesian-models.html#cb28-6" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p>We know have a <code>R</code> object that I have called <em>inits</em> and it contains the values where each of the three Markov chains will start.</p>
</div>
<div id="running-a-model-in-jags" class="section level2 hasAnchor" number="3.4">
<h2><span class="header-section-number">3.4</span> Running a model in JAGS<a href="running-bayesian-models.html#running-a-model-in-jags" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We now have the three elements that we needed: data, a model, and a set of initial values. We can now use the <code>R2jags</code> library to run our Bayesian analysis. The <code>R2jags</code> package provides an interface from <code>R</code> to the JAGS software for Bayesian data analysis. JAGS uses Markov Chain Monte Carlo (MCMC) to generate a sample from the posterior distribution of the parameters.</p>
<p>The <code>R2jags</code> function that we will use for that is the <code>jags()</code> function. Here are the arguments that we need to specify:</p>
<ul>
<li>The dataset using <code>data=</code><br />
</li>
<li>The text file containing the model written in JAGS code using <code>model.file=</code>.<br />
</li>
<li>The names of the parameters which should be monitored using <code>parameters.to.save=</code>.<br />
</li>
<li>The number of Markov chains using <code>n.chains=</code>. The default is 3.<br />
</li>
<li>The sets of initial values using <code>inits=</code>. If inits is NULL, JAGS will randomly generate values.<br />
</li>
<li>The number of total iterations per chain (including burn-in; default: 2000) using <code>n.iter=</code>.</li>
<li>The length of burn-in (i.e., number of iterations to discard at the beginning) using <code>n.burnin=</code>.</li>
<li>The thinning rate, which represent how many of the values sampled by the MCMC will be retained. The default is 5 (1 out of 5). Since there is no <em>a priori</em> need for thinning, you can specify n.thin=1, in most situations.</li>
<li>The last argument <code>DIC=TRUE</code> or <code>DIC=FALSE</code> will determine whether to compute the deviance, pD, and deviance information criteria (DIC). These could sometimes be useful for model selection/comparison. We could leave that to <code>DIC=FALSE</code> since we will not be using these values in the workshop.</li>
</ul>
<p>With the following code, we will create a <code>R</code> object called <em>bug.out</em>. This object will contains the results of running our model, with the specified priors, using the available data, and the sets of initial values that we have created. For this analysis, we have asked to run 3 Markov chains, each for 6000 iterations and we discarded the first 1000 iterations for each chain. Finally, we will monitor our only unknown parameter, <em>Prev</em> and nothing else.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="running-bayesian-models.html#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(R2jags)</span>
<span id="cb29-2"><a href="running-bayesian-models.html#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(coda)</span>
<span id="cb29-3"><a href="running-bayesian-models.html#cb29-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-4"><a href="running-bayesian-models.html#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Run the Bayesian model</span></span>
<span id="cb29-5"><a href="running-bayesian-models.html#cb29-5" aria-hidden="true" tabindex="-1"></a>bug.out <span class="ot">&lt;-</span> <span class="fu">jags</span>(<span class="at">data=</span>datalist,                             <span class="co">#Specifying the R object containing the data</span></span>
<span id="cb29-6"><a href="running-bayesian-models.html#cb29-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">model.file=</span><span class="st">&quot;model_single_prop.txt&quot;</span>,         <span class="co">#Specifying the .txt file containing the model</span></span>
<span id="cb29-7"><a href="running-bayesian-models.html#cb29-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">parameters.to.save=</span><span class="fu">c</span>(<span class="st">&quot;Prev&quot;</span>),               <span class="co">#Specifying the parameters to monitor. When &gt;1 parameter, it will be a list, ex: c(&quot;Prev&quot;, &quot;Se&quot;, &quot;Sp&quot;)</span></span>
<span id="cb29-8"><a href="running-bayesian-models.html#cb29-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">n.chains=</span><span class="dv">3</span>,                                 <span class="co">#Number of chains</span></span>
<span id="cb29-9"><a href="running-bayesian-models.html#cb29-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">inits=</span>inits,                                <span class="co">#Specifying the R object containing the initial values  </span></span>
<span id="cb29-10"><a href="running-bayesian-models.html#cb29-10" aria-hidden="true" tabindex="-1"></a>               <span class="at">n.iter=</span><span class="dv">6000</span>,                                <span class="co">#Specifying the number of iterations</span></span>
<span id="cb29-11"><a href="running-bayesian-models.html#cb29-11" aria-hidden="true" tabindex="-1"></a>               <span class="at">n.burnin=</span><span class="dv">1000</span>,                              <span class="co">#Specifying the number of iterations to remove at the begining</span></span>
<span id="cb29-12"><a href="running-bayesian-models.html#cb29-12" aria-hidden="true" tabindex="-1"></a>               <span class="at">n.thin=</span><span class="dv">1</span>,                                   <span class="co">#Specifying the thinning rate</span></span>
<span id="cb29-13"><a href="running-bayesian-models.html#cb29-13" aria-hidden="true" tabindex="-1"></a>               <span class="at">DIC=</span><span class="cn">FALSE</span>)                                  <span class="co">#Indicating that we do not request the deviance, pD, nor DIC </span></span></code></pre></div>
<pre><code>## Compiling model graph
##    Resolving undeclared variables
##    Allocating nodes
## Graph information:
##    Observed stochastic nodes: 1
##    Unobserved stochastic nodes: 1
##    Total graph size: 4
## 
## Initializing model</code></pre>
<p>As you can see, we received a few messages. It looks good, don’t you think?</p>
</div>
<div id="model-diagnostic" class="section level2 hasAnchor" number="3.5">
<h2><span class="header-section-number">3.5</span> Model diagnostic<a href="running-bayesian-models.html#model-diagnostic" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Before jumping to the results, you should first check:<br />
- Whether the chains have converged,<br />
- whether the burn-in period was long enough,<br />
- Whether you have a large enough sample of values to describe the posterior distribution with sufficient precision,<br />
- Whether the Markov chains behaved well (mainly their auto-correlation).</p>
<p>There are many diagnostic methods available for Bayesian analyses, but, for this workshop, we will mainly use basic methods relying on plots.</p>
<p>Diagnostics are available when you convert your model output into a MCMC object using the <code>as.mcmc()</code> function of the <code>mcmcplot</code> library.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="running-bayesian-models.html#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mcmcplots)</span>
<span id="cb31-2"><a href="running-bayesian-models.html#cb31-2" aria-hidden="true" tabindex="-1"></a>bug.mcmc <span class="ot">&lt;-</span> <span class="fu">as.mcmc</span>(bug.out)          <span class="co">#Converting the model output into a MCMC object (for diagnostic plots)</span></span></code></pre></div>
<p>You can then use the <code>mcmcplot()</code> function on this newly created MCMC object.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="running-bayesian-models.html#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmcplot</span>(bug.mcmc, <span class="at">title=</span><span class="st">&quot;Diagnostic plots&quot;</span>)        <span class="co">#Asking for the diagnostic plots</span></span></code></pre></div>
<p>When you do that, a HTML document will be created an your web browser will automatically open it. Here is a snapshot of the HTML file in my browser:</p>
<div class="figure">
<img src="Figures/Nice%20chains%20RM.png" alt="" />
<p class="caption"><strong>Figure.</strong> Diagnostic plots.</p>
</div>
<div id="convergence-and-burn-in" class="section level3 hasAnchor" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Convergence and burn-in<a href="running-bayesian-models.html#convergence-and-burn-in" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To check whether convergence of the Markov chains was obtained you can inspect the “running mean” (right middle figure) and “trace plot” (the bottom figure) presenting the values that were picked by each chain on each iteration. The different chains that you used (three in the preceding example) will be overlaid on the trace plot. You should inspect the trace plot to <strong>evaluate whether the different chains all converged in the same area</strong>. If so, after a number of iterations they should be moving in a relatively restricted area and this area should be the same for all chains.</p>
<p>The plots above would be a good example of the trace plot of three “nice” Markov chains (lucky us!). In this preceding example, we can see on the running mean plot that the chains started from different initial values, but they very quickly converged (after less than a 1000 iterations) toward the same area. On the trace plot, we can see the values that were stored after the burn-in period. The chains were then moving freely within this limited area (thus sampling from the posterior distribution).</p>
<p>We could conclude based on the trace plot that:<br />
- The Markov chains did converged<br />
- A short burn-in period of less than a 1000 iterations would have been sufficient. Note that we will often use a longer burn-in (e.g., 5,000 or even more) just to be sure and because it only costs a few more seconds on your computer…</p>
<p>Here is another example where two chains (the red and green) converged in the same area, but a third one (the blue) also converged, but in a different area. <strong>We should be worry in such case</strong>. We will see later the reason for such behavior.
<img src="Figures/2%20nice%201%20bad%20chain.png" alt="Figure. Trace plot - chains converging in different areas." /></p>
<p>Finally, here is a last example with just one Markov chain and it clearly did not converged, even after 25,000 iterations. <strong>You should be terrified by that!!! ;-)</strong>.<br />
<img src="Figures/non-conv%20chain.png" alt="Figure. Trace plot - chains converging in different areas." /></p>
</div>
<div id="number-of-iterations" class="section level3 hasAnchor" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Number of iterations<a href="running-bayesian-models.html#number-of-iterations" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Next, you can inspect the posterior distributions to determine if you have a large enough sample of independent values to describe with enough precision the median estimate and the 2.5th and 97.5th percentiles. The effective sample size (EES) takes into account the number of values generated by the Markov chains <strong>AND</strong> whether these values were auto-correlated, to compute the number of “effective” independent values that are used to described the posterior distribution. Chains that are auto-correlated will generate a smaller number of “effective values” than chains that are not auto-correlated.</p>
<p>The <code>effectiveSize()</code> function of the <code>coda</code> library provide a way to appraise whether you add enough iterations. In the current example, we already created a <code>mcmc</code> object named <code>bug.mcmc</code>. We can ask for the effective sample size as follow:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="running-bayesian-models.html#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">effectiveSize</span>(bug.mcmc)         <span class="co">#Asking for the ESS</span></span></code></pre></div>
<pre><code>##     Prev 
## 9038.367</code></pre>
<p>So we see here that, despite having stored 3 times 5,000 values (15,000 values), we have the equivalent of a bit more than 9,000 independent values. What to do with this information? Well, you could, for instance, decide on an arbitrary rule for ESS (say 10,000 values) and then adapt the length of the chains to achieve such an ESS (for each of the selected parameters, because the effective sample sizes will not be the same for all parameters).</p>
</div>
<div id="auto-correlation" class="section level3 hasAnchor" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Auto-correlation<a href="running-bayesian-models.html#auto-correlation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Remember, a feature of Markov chains is to have some auto-correlation between two immediately subsequent iterations and then a correlation that quickly goes down to zero (i.e., they have a short memory). The auto-correlation plot can be used to assess if this feature is respected.</p>
<p>From our previous example (check the upper right figure in the plot below), it seems that it is the case.<br />
<img src="Figures/Nice%20chains%20RM.png" alt="Figure. Autocorrelation plot with Markov chains exhibiting a short memory." /></p>
<p>Here is another example that should be worrying.<br />
<img src="Figures/Autocor%20bad.png" alt="Figure. Autocorrelation plot with Markov chains exhibiting a long memory." /></p>
<p>When such a behavior is observed, running the chains for more iterations will help achieve the desire ESS. In some situations, specifying different priors (i.e., increasing the amount of information in priors) may also help.</p>
</div>
</div>
<div id="getting-our-estimates" class="section level2 hasAnchor" number="3.6">
<h2><span class="header-section-number">3.6</span> Getting our estimates<a href="running-bayesian-models.html#getting-our-estimates" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Now, if you are happy with the behavior of your Markov chains, the number of iterations, and burn-in period, you can summarize your results (i.e., report the median, 2.5th and 97.5th percentiles) very easily with the <code>print()</code> function. Below, I have also indicated <code>digits.summary=3</code> to adjust the precision of the estimates that are reported (the default is 1).</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="running-bayesian-models.html#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(bug.out,                  <span class="co">#Asking to see the mean, median, etc of the unknown parameters that were monitored</span></span>
<span id="cb35-2"><a href="running-bayesian-models.html#cb35-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">digits.summary=</span><span class="dv">3</span>)         <span class="co">#Requiring a precision of 3 digits</span></span></code></pre></div>
<pre><code>## Inference for Bugs model at &quot;model_single_prop.txt&quot;, fit using jags,
##  3 chains, each with 6000 iterations (first 1000 discarded)
##  n.sims = 15000 iterations saved
##      mu.vect sd.vect  2.5%   25%   50%   75% 97.5%  Rhat n.eff
## Prev   0.303   0.044 0.219 0.273 0.303 0.334 0.392 1.001 15000
## 
## For each parameter, n.eff is a crude measure of effective sample size,
## and Rhat is the potential scale reduction factor (at convergence, Rhat=1).</code></pre>
<p>Here you see that the median <em>Prev</em> estimate (95CI) was (after rounding off) 0.30 (0.22, 0.40).</p>
<p>You can also ask for plotting the <em>bug.mcmc</em> object that you have created using the <code>plot()</code> function. It would produce the trace plot and a density plot presenting the posterior distributions of each unknown parameter.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="running-bayesian-models.html#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(bug.mcmc)              <span class="co">#Asking for trace plot and plots of prior and posterior distributions</span></span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-25"></span>
<img src="_main_files/figure-html/unnamed-chunk-25-1.png" alt="Trace plot and density plot produced using the plot() function." width="672" />
<p class="caption">
Figure 3.1: Trace plot and density plot produced using the plot() function.
</p>
</div>
<p>If you prefer to work on your own plots, note that all the values sampled from your posterior distributions were stored in the <em>bug.out</em> object that you have created. If you inspect the <em>bug.out</em> object, you will notice an element named <em>BUGSoutput</em>, inside this element, there is another object named <em>sims.list</em>, within this <em>sims.list</em>, there is an element named <em>Prev</em>. As you can see below, this element is made of a list of 15000 values. This correspond to the 5000 values sampled (1/iteration) by each Markov chain (3 chains) for the unknown parameter <em>Prev</em>. <strong>So this element is simply all the sampled values assembled together</strong>.</p>
<div class="figure">
<img src="Figures/sims%20list.png" alt="" />
<p class="caption">sims.list object located in the <em>bug.out</em> output.</p>
</div>
<p>You could use this element, for instance, to plot together the prior and posterior distributions on a same figure. On the figure below, the prior distribution is not obvious, it is the flat dashed red line just above the x axis (remember, we used a flat prior for <em>Prev</em>).</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="running-bayesian-models.html#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot the posterior distribution</span></span>
<span id="cb38-2"><a href="running-bayesian-models.html#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(<span class="at">x=</span>bug.out<span class="sc">$</span>BUGSoutput<span class="sc">$</span>sims.list<span class="sc">$</span>Prev),      <span class="co">#Indicating variable to plot</span></span>
<span id="cb38-3"><a href="running-bayesian-models.html#cb38-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="st">&quot;Disease prevalence&quot;</span>,                         <span class="co">#Title for the plot</span></span>
<span id="cb38-4"><a href="running-bayesian-models.html#cb38-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">&quot;Prevalence&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Density&quot;</span>,                 <span class="co">#x and y axis titles</span></span>
<span id="cb38-5"><a href="running-bayesian-models.html#cb38-5" aria-hidden="true" tabindex="-1"></a>     )</span>
<span id="cb38-6"><a href="running-bayesian-models.html#cb38-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-7"><a href="running-bayesian-models.html#cb38-7" aria-hidden="true" tabindex="-1"></a><span class="co">#plot the prior distribution</span></span>
<span id="cb38-8"><a href="running-bayesian-models.html#cb38-8" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dbeta</span>(x, <span class="at">shape1=</span>Prev.shapea, <span class="at">shape2=</span>Prev.shapeb), <span class="at">from=</span><span class="dv">0</span>, <span class="at">to=</span><span class="dv">1</span>,          <span class="co">#Plotting the corresponding prior distribution</span></span>
<span id="cb38-9"><a href="running-bayesian-models.html#cb38-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">lty=</span><span class="dv">2</span>,                                                                   <span class="co">#Asking for a dashed line pattern</span></span>
<span id="cb38-10"><a href="running-bayesian-models.html#cb38-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">col=</span><span class="st">&quot;red&quot;</span>,                                                               <span class="co">#Asking for a red line  </span></span>
<span id="cb38-11"><a href="running-bayesian-models.html#cb38-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">add=</span><span class="cn">TRUE</span>)                                                                <span class="co">#Asking to add this plot to the preceding one</span></span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-26"></span>
<img src="_main_files/figure-html/unnamed-chunk-26-1.png" alt="Prior (dashed red line) and posterior (full black line) distribution of the prevalence of disease." width="672" />
<p class="caption">
Figure 3.2: Prior (dashed red line) and posterior (full black line) distribution of the prevalence of disease.
</p>
</div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="distributions.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="exercise-1---proportions.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/02-JAGS.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
